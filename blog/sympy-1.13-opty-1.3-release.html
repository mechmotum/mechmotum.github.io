<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  Biomechanical Optimization with SymPy 1.13 and Opty 1.3 | Bicycle Laboratorium
</title>
  <link rel="canonical" href="https://mechmotum.github.io/blog/sympy-1.13-opty-1.3-release.html">


  <link rel="stylesheet" href="https://mechmotum.github.io/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://mechmotum.github.io/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="https://mechmotum.github.io/theme/css/pygments/default.min.css">
  <link rel="stylesheet" href="https://mechmotum.github.io/theme/css/theme.css">
  <link rel="stylesheet" href="https://mechmotum.github.io/theme/css/origtheme.css">

  <link rel="alternate" type="application/atom+xml" title="Full Atom Feed"
        href="https://mechmotum.github.io/feeds/all.atom.xml">
  <link rel="alternate" type="application/atom+xml" title="Categories Atom Feed"
        href="https://mechmotum.github.io/feeds/research.atom.xml">  
  <meta name="description" content="SymPy 1.13 and Opty 1.3 can now be used for optimal control solutions of muscle-driven biomechanical simulation. This blog post shows of a solution to a muscle driven cycling time trial.">


</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
    <div class="col-sm-4">
      <a href="https://mechmotum.github.io/">
        <img class="site-image img-fluid rounded" src=https://objects-us-east-1.dream.io/mechmotum/bear-bicycle-transparent-480x480.png alt="Bicycle Laboratorium">
      </a>
    </div>
  <div class="col-sm-8">
    <img src=https://objects-us-east-1.dream.io/mechmotum/tu-delft-logo-233x100.png height=100px>
    <h1 class="title"><a href="https://mechmotum.github.io/">Bicycle Laboratorium</a></h1>
      <p class="text-muted">E pur si muove</p>
      <ul class="list-inline">
            <li class="list-inline-item"><a href="https://mechmotum.github.io/">About</a></li>
            <li class="list-inline-item"><a href="https://mechmotum.github.io/members.html">Members</a></li>
            <li class="list-inline-item"><a href="https://mechmotum.github.io/research.html">Research</a></li>
            <li class="list-inline-item"><a href="https://mechmotum.github.io/products.html">Products</a></li>
            <li class="list-inline-item"><a href="https://mechmotum.github.io/jobs.html">Positions</a></li>
            <li class="list-inline-item"><a href="https://mechmotum.github.io/guide.html">Guide</a></li>
            <li class="list-inline-item"><a href="https://mechmotum.github.io/contact.html">Contact</a></li>
          <li class="list-inline-item"><a href="/blog/">Blog</a></li>
      </ul>
  </div>
</div>    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  Biomechanical Optimization with SymPy 1.13 and Opty 1.3
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2024-08-05T00:00:00-07:00">
          <i class="fas fa-clock"></i>
          Mon 05 August 2024
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="https://mechmotum.github.io/category/research.html">research</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-user"></i>
              <a href="https://mechmotum.github.io/author/jason-k-moore.html">Jason K. Moore</a>          </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="https://mechmotum.github.io/tag/sympy.html">#sympy</a>,               <a href="https://mechmotum.github.io/tag/czi.html">#czi</a>,               <a href="https://mechmotum.github.io/tag/biomechanics.html">#biomechanics</a>,               <a href="https://mechmotum.github.io/tag/multibody-dynamics.html">#multibody dynamics</a>,               <a href="https://mechmotum.github.io/tag/open-source-software.html">#open source software</a>,               <a href="https://mechmotum.github.io/tag/muscles.html">#muscles</a>,               <a href="https://mechmotum.github.io/tag/optimal-control.html">#optimal control</a>,               <a href="https://mechmotum.github.io/tag/bicycle.html">#bicycle</a>,               <a href="https://mechmotum.github.io/tag/code-generation.html">#code generation</a>          </li>
      </ul>
    </header>


    <div class="content">
      <p><a class="reference external" href="https://github.com/sympy/sympy/releases/tag/1.13.0">SymPy 1.13</a> was released on July 8, 2024. This release includes <a class="reference external" href="https://mechmotum.github.io/blog/czi-sympy-wrapup.html">all of the
work we did under the CZI Open Source Software for Science Cycle 4 grant</a>. For example, SymPy now includes new features
for modeling biomechanical multibody systems. The new features include model
construction from joints via a system manager and force actuator classes
including a musculo-tendon model. At the close of the grant period, we
demonstrated how these features can be used in the solution of biomechanical
trajectory optimization and parameter estimation optimal control problems, but
only from development branches of the various intertwined software packages.
Today, we released <a class="reference external" href="https://github.com/csu-hmc/opty/releases/tag/v1.3.0">Opty 1.3</a> which can now be used alongside SymPy 1.13 to solve
biomechanical optimal control problems. Opty can now handle symbolic equations
of motion that have many millions of mathematical operations and tens of
thousands of constraints and optimization variables. To help grow adoption,
we've built out a new example gallery that demonstrates how Opty can be used to
solve a variety of problems:</p>
<div class="figure align-center">
<a class="reference external image-reference" href="https://opty.readthedocs.io/stable/examples/index.html">
<img alt="" src="https://objects-us-east-1.dream.io/mechmotum/opty-1.3-examples.png" />
</a>
<p class="caption">Opty 1.3's new example gallery.</p>
</div>
<p>One example in the gallery, the &quot;<a class="reference external" href="https://opty.readthedocs.io/stable/examples/plot_one_legged_time_trial.html">One-Legged Cycling Time Trial</a>&quot;,
shows how to find an optimal control solution of a musculo-tendon driven model
that makes use of SymPy 1.13's new biomechanics features. We developed this
example for an activity in TU Delft's 2024 Sports Engineering course to show
the students how models can be used to study how muscles play a role in optimal
performance. The example solves a minimum time cycling race using a model of a
single leg and simplified muscles that drive the leg motion to propel the
bicycle. The example in the gallery is set up with a short race distance but if
you bump the distance up to 80 meters the cyclist starts approaching terminal
velocity. Opty can find an optimal solution for the 17,000 variables in this
problem in about 10 minutes on an AMD Ryzen 5 2600X 12 core machine.</p>
<p>This produces a reasonably realistic overall motion which can be seen in the
cadence, resulting speed, and the power to accelerate and overcome rolling and
air resistance:</p>
<img alt="" class="align-center" src="https://objects-us-east-1.dream.io/mechmotum/one-legged-80m-power.png" />
<p>There is no limit on the fatigue of the muscles so the optimizer finds a
bang-bang style coordination of the muscle excitations to power the leg and
push the muscles to their maximum force production:</p>
<div class="figure align-center">
<img alt="" src="https://objects-us-east-1.dream.io/mechmotum/one-legged-80m-muscle.png" />
<p class="caption">The four muscle forces, muscle lengths, and muscle excitations versus time
during the 80 meter time trial with the minimum race time shown at the top.</p>
</div>
<p>This solution results in this overall pedaling motion:</p>
<center>
  <video controls>
    <source src="https://objects-us-east-1.dream.io/mechmotum/one-legged-80m.mp4" type="video/mp4">
  </video>
</center><p>Our next step is to incorporate muscles in our 3D nonlinear bicycle-rider
models to enable deeper understanding of how bicycles are balanced and
controlled. Opty can quickly find optimal trajectories of the joint torque
driven model, as shown in our <a class="reference external" href="https://doi.org/10.59490/660179a06bf1082286458109">BRiM paper</a>:</p>
<div class="figure align-center">
<img alt="" src="https://objects-us-east-1.dream.io/mechmotum/brim-paper-opty-example.png" />
<p class="caption">Torque driven Opty optimal control solution for the non-linear
Carvallo-Whipple bicycle model.</p>
</div>
<p>Thanks to Timo, Sam, Peter, and all the SymPy developers for the contributions
that helped pull all this together! We hope that others can make use of these
models and tools for their own work.</p>

    </div>
  </article>
  <hr>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function() {
      this.page.url = 'https://mechmotum.github.io/blog/sympy-1.13-opty-1.3-release.html';
      this.page.identifier = 'biomechanical-optimization-with-sympy-113-and-opty-13';
    };
    (function() {
      var d = document;
      var s = d.createElement('script');
      s.src = '//mechmotum.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript class="text-muted">
    Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
  </noscript>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
      <li class="list-inline-item"><a href="https://mechmotum.github.io/authors.html">Authors</a></li>
    <li class="list-inline-item"><a href="https://mechmotum.github.io/archives.html">Archives</a></li>
    <li class="list-inline-item"><a href="https://mechmotum.github.io/categories.html">Categories</a></li>
      <li class="list-inline-item"><a href="https://mechmotum.github.io/tags.html">Tags</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy"
         target="_blank">&#x2728;</a>
    | Edit on <a href="https://github.com/mechmotum/mechmotum.github.io" target="_blank"><i class="fab fa-github"></i></a>
  </p>
</div>
<div class="row">
  <div class="col-sm-4 mx-auto text-center text-muted" >
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
      <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
    </a>
    <br />
    This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
  </div>
</div>    </div>
  </footer>

</body>

</html>