<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  Estimating Competition Rowing Metrics | Bicycle Laboratorium
</title>
  <link rel="canonical" href="https://mechmotum.github.io/blog/estimating-rowing-metrics.html">


  <link rel="stylesheet" href="https://mechmotum.github.io/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://mechmotum.github.io/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="https://mechmotum.github.io/theme/css/pygments/default.min.css">
  <link rel="stylesheet" href="https://mechmotum.github.io/theme/css/theme.css">
  <link rel="stylesheet" href="https://mechmotum.github.io/theme/css/origtheme.css">

  <link rel="alternate" type="application/atom+xml" title="Full Atom Feed"
        href="https://mechmotum.github.io/feeds/all.atom.xml">
  <link rel="alternate" type="application/atom+xml" title="Categories Atom Feed"
        href="https://mechmotum.github.io/feeds/papers.atom.xml">  
  <meta name="description" content="Our paper on the sensor fusion of iPhone sensor streams is currently available for preprint at https://engrxiv.org/nykuh.">


</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
    <div class="col-sm-4">
      <a href="https://mechmotum.github.io/">
        <img class="img-fluid rounded" src=https://objects-us-east-1.dream.io/mechmotum.github.io/bear-bicycle-480x480.png alt="Bicycle Laboratorium">
      </a>
    </div>
  <div class="col-sm-8">
    <img src=https://objects-us-east-1.dream.io/mechmotum/tu-delft-logo-233x100.png>
    <h1 class="title"><a href="https://mechmotum.github.io/">Bicycle Laboratorium</a></h1>
      <p class="text-muted">E pur si muove</p>
      <ul class="list-inline">
            <li class="list-inline-item"><a href="https://mechmotum.github.io/members.html">Members</a></li>
            <li class="list-inline-item"><a href="https://mechmotum.github.io/research.html">Research</a></li>
            <li class="list-inline-item"><a href="https://mechmotum.github.io/products.html">Products</a></li>
            <li class="list-inline-item"><a href="https://mechmotum.github.io/jobs.html">Jobs</a></li>
            <li class="list-inline-item"><a href="https://mechmotum.github.io/guide.html">Guide</a></li>
          <li class="list-inline-item"><a href="/blog/">Blog</a></li>
      </ul>
  </div>
</div>    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  Estimating Competition Rowing Metrics
</h1>
      <hr>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2019-01-18T13:25:00-08:00">
          <i class="fas fa-clock"></i>
          Fri 18 January 2019
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="https://mechmotum.github.io/category/papers.html">papers</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-user"></i>
              <a href="https://mechmotum.github.io/author/bryn-cloud.html">Bryn Cloud</a>,               <a href="https://mechmotum.github.io/author/britt-tarien.html">Britt Tarien</a>,               <a href="https://mechmotum.github.io/author/ada-liu.html">Ada Liu</a>,               <a href="https://mechmotum.github.io/author/thomas-shedd.html">Thomas Shedd</a>          </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="https://mechmotum.github.io/tag/rowing.html">#rowing</a>,               <a href="https://mechmotum.github.io/tag/sports.html">#sports</a>,               <a href="https://mechmotum.github.io/tag/engineering.html">#engineering</a>,               <a href="https://mechmotum.github.io/tag/estimation.html">#estimation</a>,               <a href="https://mechmotum.github.io/tag/kalman-filter.html">#kalman filter</a>          </li>
      </ul>
    </header>


    <div class="content">
      <p>This blog post provides a brief description of the primary ideas and results
that will be found in the paper, &quot;Adaptive smartphone-based sensor fusion for
estimating competitive rowing kinematic metrics&quot;.</p>
<div class="section" id="goal">
<h2>Goal</h2>
<p>Competitive rowing highly values boat position and velocity data for real-time
feedback during training, racing and post-training analysis.  The ubiquity of
smartphones with embedded position (GPS) and motion (accelerometer) sensors
motivates their possible use in these tasks. We investigate the use of two
real-time digital filters to achieve extremely accurate but reasonably priced
measures of boat speed and distance per stroke.</p>
</div>
<div class="section" id="problem">
<h2>Problem</h2>
<p>Rowers are primarily concerned with maximizing the speed of their boat and the
distance they can cover in each stroke. For this reason, we focus on increasing
the accuracy of these two metrics. The GPS from the iPhone samples about once
every three seconds, so there is not enough resolution to see what happens
within a stroke (which takes about 2 seconds). The accelerometer has an
acceptable sampling frequency of 100 Hz, but since rowers are interested in
speed and position, it must be integrated or double integrated which introduces
a steep low-frequency drift.</p>
</div>
<div class="section" id="solution">
<h2>Solution</h2>
<div class="section" id="complementary-filter">
<h3>Complementary Filter</h3>
<p>The integrated acceleration is high-pass filtered to get rid of the
low-frequency drift, but keeps the high-frequency resolution within each
stroke. The GPS is low-pass filtered to get rid of any high-frequency noise.
These two signals are then summed together.</p>
<p>To get a more accurate result, we apply a linear extrapolation of the previous
two GPS position points to get a more accurate prediction between the 0.3 Hz
data points.</p>
<p>We use an optimization on each of our 16 data files to generate the optimal low
and high cutoff frequencies. We are then able to use the average values over
all runs in the filter. With the cutoff frequencies already built in, the
filter only needs the previous two data points to operate and runs in real
time.</p>
</div>
<div class="section" id="kalman-filter">
<h3>Kalman Filter</h3>
<p>The Kalman filter algorithm fuses data collected from different sensors with
the outputs of a predictive dynamic physical model to estimate the target
time-varying variables of interest, known as states. In our case, the
body-fixed longitudinal acceleration of the boat is measured and used as an
input to a kinematic model to predict the displacement and speed of the boat
along its path. The predictions are then compared with the smartphone
GPS-derived distance traveled and speed measurement and the error is used as
feedback to adjust the estimation in real time. The Kalman gain can be tuned to
balance the sensor and model uncertainty to achieve optimal accuracy.</p>
<p>The smartphone's accelerometer axis is not, in general, parallel to the boat's
horizontal travel path. If we want to use the smartphone acceleration for the
kinematic model, we must compensate for the sensor misalignment along with
varying boat pitch during rowing. This can be done by augmenting the
accelerometer's reading (<span class="math">\(\phi_k\)</span>).</p>
<p>Therefore, the kinematic model for the Kalman Filter is as follows:</p>
<div class="math">
\begin{align*}
d_{k+1} = d_k+ v_k \Delta t \\
v_{k+1} = v_k + (\alpha_{y,k} - \phi_k) \Delta t
\end{align*}
</div>
<p>This bias term now becomes a new state to be estimated by the filter which will
effectively account for drift due to integration error accumulation.</p>
</div>
<div class="section" id="experimental-validation">
<h3>Experimental Validation</h3>
<p>We used a differential GPS system (accurate to ~3mm) to define our &quot;ground
truth&quot; data.  We simultaneously logged data on the differential GPS and the
iPhone while a rower performed passes at various speeds up and down a lake. We
collected data on two different rower-boat configuration: a single scull boat
(one seat) with an elite rower, and a double scull boat (two seats) with a
single amateur rower.  These offered two very different styles of rowing, so if
our filters can perform well on both, then we know they are robust.</p>
</div>
</div>
<div class="section" id="results">
<h2>Results</h2>
<p>The figure below compares the distance per stroke estimation computed from the
smartphone GPS, complementary filter, and Kalman filter through the relative
error with respect to the the distance per stroke computed from the
differential GPS measurements.</p>
<img alt="" class="align-center" src="https://objects-us-east-1.dream.io/mechmotum/dps.png" style="width: 50%;" />
<p>Example boat speed estimates over 30 seconds during a typical trial comparing
smartphone GPS derived speed and the complementary filter and Kalman filter
outputs against the differential GPS is shown in Figure 2.  RMSE is calculated
with respect to the sampling rate of the accelerometer, 100 Hz.</p>
<img alt="" class="align-center" src="https://objects-us-east-1.dream.io/mechmotum/speed-example.png" style="width: 50%;" />
</div>
<div class="section" id="discussion">
<h2>Discussion</h2>
<p>We have presented two methods to estimate the speed and distance per stroke
along a rowing boat's path in real time that provide high accuracy and
precision from the relatively low accuracy sensors from a single smartphone
attached to the boat. These estimates provide an intimate view of the rower's
performance. These improved estimates can be used to create a more detailed
analysis of the rower's performance. Specifically, we show that the distance
per stroke can be estimated to an accuracy of 50~si{centimeter}, which is an
improvement over smartphone estimates but still insufficient for detailed
stroke-by-stroke level differentiation of boats in a racing event with
relatively close elapsed times.  Additionally, the inter-stroke view of boat
speed that our methods provide are better than any inexpensive commercial
on-board boat speed measurement device and compares favorably to very accurate
differential GPS systems without the need for more than one GPS receiver.</p>
<p>The complementary filter has a disadvantage in that the filter cutoff
frequencies aren't updated to optimal values in real time, and the optimal
offline values we make use of do not robustly handle all stroke rates for the
two rowers and boats used. This makes the Kalman filter more attractive because
the bias term is adaptively updated for every rower and boat. The filter tunes
itself. Both filters take time to converge to a steady error from a zero speed
start, so the first strokes in a race will produce less accurate results. A
future study could look into minimizing the startup time by tuning the filters
further, but there is likely a tradeoff in accuracy and precision of the
estimations.</p>
<p>Other related information:</p>
<ul class="simple">
<li>Preprint: <a class="reference external" href="https://engrxiv.org/nykuh">https://engrxiv.org/nykuh</a></li>
<li>Software repository: <a class="reference external" href="https://gitlab.com/mechmotum/row_filter">https://gitlab.com/mechmotum/row_filter</a></li>
</ul>
</div>
<script type='text/javascript'>if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
    </div>
  </article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
      <li class="list-inline-item"><a href="https://mechmotum.github.io/authors.html">Authors</a></li>
    <li class="list-inline-item"><a href="https://mechmotum.github.io/archives.html">Archives</a></li>
    <li class="list-inline-item"><a href="https://mechmotum.github.io/categories.html">Categories</a></li>
      <li class="list-inline-item"><a href="https://mechmotum.github.io/tags.html">Tags</a></li>
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>
<div class="row">
  <div class="col-sm-4 mx-auto text-center text-muted" >
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
      <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
    </a>
    <br />
    This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
  </div>
</div>    </div>
  </footer>

</body>

</html>